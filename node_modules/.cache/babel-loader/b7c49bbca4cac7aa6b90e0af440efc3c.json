{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/Andy Kwan/Desktop/ryan_subs/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Andy Kwan/Desktop/ryan_subs/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Andy Kwan\\\\Desktop\\\\ryan_subs\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useState,useEffect,useContext,Fragment}from'react';import axios from'axios';import{UserOutlined}from'@ant-design/icons';import moment from'moment';import UserContext from'../context';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Account=function Account(_ref){var history=_ref.history;var _useContext=useContext(UserContext),_useContext2=_slicedToArray(_useContext,2),state=_useContext2[0],setState=_useContext2[1];var _useState=useState([]),_useState2=_slicedToArray(_useState,2),subscriptions=_useState2[0],setSubscriptions=_useState2[1];var getSubscriptions=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/subscriptions');case 2:_yield$axios$get=_context.sent;data=_yield$axios$get.data.data;setSubscriptions(data);case 5:case\"end\":return _context.stop();}}},_callee);}));return function getSubscriptions(){return _ref2.apply(this,arguments);};}();var manageSubscriptions=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$axios$get2,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('/customer-portal');case 2:_yield$axios$get2=_context2.sent;data=_yield$axios$get2.data;window.open(data);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function manageSubscriptions(){return _ref3.apply(this,arguments);};}();useEffect(function(){if(!state||!state.token)return;getSubscriptions();},[state]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(UserOutlined,{className:\"display-4\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Account\"}),/*#__PURE__*/_jsx(\"p\",{className:\"lead pb-4\",children:\"Subscription Status\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:subscriptions===null||subscriptions===void 0?void 0:subscriptions.map(function(sub){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h4\",{className:\"fw-bold\",children:sub.plan.nickname}),/*#__PURE__*/_jsx(\"h5\",{children:(sub.plan.amount/100).toLocaleString(\"en-US\",{style:\"currency\",currency:sub.plan.currency})}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status: \",sub.status]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Card last 4 digit: \",sub.default_payment_method.card.last4]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Current Period end: \",moment(sub.current_period_end*1000).format('dddd, MMMM Do YYYY h:mm:ss').toString()]}),sub.status==='active'?/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-info p-2\",onClick:function onClick(){return history.push(\"/\".concat(sub.plan.nickname.toLowerCase()));},children:\"Access\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-warning p-2 mx-4\",onClick:manageSubscriptions,children:\"Manage Subscription\"})]}):\"\"]})},sub.id);})})]});};export default Account;","map":{"version":3,"sources":["C:/Users/Andy Kwan/Desktop/ryan_subs/client/src/pages/Account.js"],"names":["useState","useEffect","useContext","Fragment","axios","UserOutlined","moment","UserContext","Account","history","state","setState","subscriptions","setSubscriptions","getSubscriptions","get","data","manageSubscriptions","window","open","token","map","sub","plan","nickname","amount","toLocaleString","style","currency","status","default_payment_method","card","last4","current_period_end","format","toString","push","toLowerCase","id"],"mappings":"gZAAA,OAASA,QAAT,CAAmBC,SAAnB,CAA8BC,UAA9B,CAA0CC,QAA1C,KAA0D,OAA1D,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,YAAT,KAA6B,mBAA7B,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,CAEA,MAAOC,CAAAA,WAAP,KAAwB,YAAxB,C,wFAEA,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,MAAiB,IAAdC,CAAAA,OAAc,MAAdA,OAAc,CAC7B,gBAA0BP,UAAU,CAACK,WAAD,CAApC,4CAAOG,KAAP,iBAAcC,QAAd,iBACA,cAA0CX,QAAQ,CAAC,EAAD,CAAlD,wCAAOY,aAAP,eAAsBC,gBAAtB,eAEA,GAAMC,CAAAA,gBAAgB,2FAAG,mLACYV,CAAAA,KAAK,CAACW,GAAN,CAAU,gBAAV,CADZ,uCACLC,IADK,kBACbA,IADa,CACLA,IADK,CAErBH,gBAAgB,CAACG,IAAD,CAAhB,CAFqB,sDAAH,kBAAhBF,CAAAA,gBAAgB,2CAAtB,CAKA,GAAMG,CAAAA,mBAAmB,2FAAG,0LACDb,CAAAA,KAAK,CAACW,GAAN,CAAU,kBAAV,CADC,yCAChBC,IADgB,mBAChBA,IADgB,CAExBE,MAAM,CAACC,IAAP,CAAYH,IAAZ,EAFwB,wDAAH,kBAAnBC,CAAAA,mBAAmB,2CAAzB,CAKAhB,SAAS,CAAC,UAAM,CACZ,GAAI,CAACS,KAAD,EAAU,CAACA,KAAK,CAACU,KAArB,CAA4B,OAC5BN,gBAAgB,GACnB,CAHQ,CAGN,CAACJ,KAAD,CAHM,CAAT,CAKA,mBACI,aAAK,SAAS,CAAC,WAAf,wBACI,aAAK,SAAS,CAAC,KAAf,wBACI,KAAC,YAAD,EAAc,SAAS,CAAC,WAAxB,EADJ,cAEI,+BAFJ,cAGI,UAAG,SAAS,CAAC,WAAb,iCAHJ,GADJ,cAOI,YAAK,SAAS,CAAC,KAAf,UACKE,aADL,SACKA,aADL,iBACKA,aAAa,CAAES,GAAf,CAAmB,SAAAC,GAAG,qBACnB,kCACI,wCACI,aADJ,cAEI,WAAI,SAAS,CAAC,SAAd,UAAyBA,GAAG,CAACC,IAAJ,CAASC,QAAlC,EAFJ,cAGI,oBACK,CAACF,GAAG,CAACC,IAAJ,CAASE,MAAT,CAAkB,GAAnB,EAAwBC,cAAxB,CAAuC,OAAvC,CAAgD,CAC7CC,KAAK,CAAE,UADsC,CAE7CC,QAAQ,CAAEN,GAAG,CAACC,IAAJ,CAASK,QAF0B,CAAhD,CADL,EAHJ,cASI,gCAAYN,GAAG,CAACO,MAAhB,GATJ,cAUI,2CAAuBP,GAAG,CAACQ,sBAAJ,CAA2BC,IAA3B,CAAgCC,KAAvD,GAVJ,cAWI,4CAEQ1B,MAAM,CAACgB,GAAG,CAACW,kBAAJ,CAAyB,IAA1B,CAAN,CACKC,MADL,CACY,4BADZ,EAEKC,QAFL,EAFR,GAXJ,CAkBKb,GAAG,CAACO,MAAJ,GAAe,QAAf,cACG,MAAC,QAAD,yBACI,eACI,SAAS,CAAC,0BADd,CAEI,OAAO,CAAE,yBAAMpB,CAAAA,OAAO,CAAC2B,IAAR,YAAiBd,GAAG,CAACC,IAAJ,CAASC,QAAT,CAAkBa,WAAlB,EAAjB,EAAN,EAFb,oBADJ,cAOI,eACI,SAAS,CAAC,kCADd,CAEI,OAAO,CAAEpB,mBAFb,iCAPJ,GADH,CAeG,EAjCR,GADJ,EAAUK,GAAG,CAACgB,EAAd,CADmB,EAAtB,CADL,EAPJ,GADJ,CAmDH,CAtED,CAwEA,cAAe9B,CAAAA,OAAf","sourcesContent":["import { useState, useEffect, useContext, Fragment } from 'react';\r\nimport axios from 'axios';\r\nimport { UserOutlined } from '@ant-design/icons';\r\nimport moment from 'moment';\r\n\r\nimport UserContext from '../context';\r\n\r\nconst Account = ({ history }) => {\r\n    const [state, setState] = useContext(UserContext);\r\n    const [subscriptions, setSubscriptions] = useState([]);\r\n\r\n    const getSubscriptions = async () => {\r\n        const { data: { data } } = await axios.get('/subscriptions');\r\n        setSubscriptions(data);\r\n    };\r\n\r\n    const manageSubscriptions = async () => {\r\n        const { data } = await axios.get('/customer-portal');\r\n        window.open(data);\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (!state || !state.token) return;\r\n        getSubscriptions();\r\n    }, [state]);\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <div className=\"row\">\r\n                <UserOutlined className=\"display-4\" />\r\n                <h1>Account</h1>\r\n                <p className=\"lead pb-4\">Subscription Status</p>\r\n            </div>\r\n\r\n            <div className=\"row\">\r\n                {subscriptions?.map(sub => (\r\n                    <div key={sub.id}>\r\n                        <section>\r\n                            <hr />\r\n                            <h4 className=\"fw-bold\">{sub.plan.nickname}</h4>\r\n                            <h5>\r\n                                {(sub.plan.amount / 100).toLocaleString(\"en-US\", {\r\n                                    style: \"currency\",\r\n                                    currency: sub.plan.currency\r\n                                })}\r\n                            </h5>\r\n                            <p>Status: {sub.status}</p>\r\n                            <p>Card last 4 digit: {sub.default_payment_method.card.last4}</p>\r\n                            <p>\r\n                                Current Period end: {\r\n                                    moment(sub.current_period_end * 1000)\r\n                                        .format('dddd, MMMM Do YYYY h:mm:ss')\r\n                                        .toString()\r\n                                }\r\n                            </p>\r\n                            {sub.status === 'active' ? (\r\n                                <Fragment>\r\n                                    <button \r\n                                        className=\"btn btn-outline-info p-2\"\r\n                                        onClick={() => history.push(`/${sub.plan.nickname.toLowerCase()}`)}\r\n                                    >\r\n                                        Access\r\n                                    </button>\r\n                                    <button \r\n                                        className=\"btn btn-outline-warning p-2 mx-4\"\r\n                                        onClick={manageSubscriptions}\r\n                                    >\r\n                                        Manage Subscription\r\n                                    </button>\r\n                                </Fragment>\r\n                            ) : \"\"}\r\n                        </section>\r\n                    </div>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Account;"]},"metadata":{},"sourceType":"module"}